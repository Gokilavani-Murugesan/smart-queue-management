<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Login | Smart Queue</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
* { box-sizing: border-box; font-family: "Segoe UI", sans-serif; }
body { margin:0; min-height:100vh; background: linear-gradient(135deg,#1d2671,#c33764); display:flex; justify-content:center; align-items:center;}
.login-box { width:90%; max-width:400px; background: rgba(255,255,255,0.15); backdrop-filter: blur(20px); border-radius:20px; padding:30px; box-shadow:0 8px 32px rgba(0,0,0,0.3); color:white; text-align:center;}
form { display:flex; flex-direction:column; gap:15px; margin-top:10px;}
label { text-align:left; font-weight:500;}
input[type="email"], input[type="password"] { padding:10px 12px; border-radius:10px; border:none; outline:none; font-size:15px;}
input[type="submit"] { background:#ffd700; color:#1d2671; font-weight:bold; padding:12px; border:none; border-radius:12px; cursor:pointer; transition:0.3s;}
input[type="submit"]:hover { background:#fff; color:#c33764;}
#message { margin-top:15px; font-weight:bold; font-size:14px;}
.register-link { margin-top:15px; font-size:14px; }
.register-link a { color: #00ffcc; text-decoration: none; font-weight: 500; }
.register-link a:hover { color: #ffd700; }
.footer { text-align:center; margin-top:20px; font-size:13px; opacity:0.8;}
</style>
</head>
<body>

<div class="login-box">
    <h2>Login to Smart Queue</h2>

    <form id="loginForm">
        <label>Email</label>
        <input type="email" id="email" name="email" placeholder="Enter email" required>

        <label>Password</label>
        <input type="password" id="password" name="password" placeholder="Enter password" required>

        <input type="submit" value="Login">
    </form>

    <div id="message"></div>

    <div class="register-link">
        Don't have an account? <a href="Registration.html">Register here</a>
    </div>

    <div class="footer">
        Smart Queue System Â© 2025
    </div>
</div>

<script>
document.getElementById("loginForm").addEventListener("submit", function(e){
    e.preventDefault();

    const formData = new URLSearchParams();
    formData.append("email", document.getElementById("email").value);
    formData.append("password", document.getElementById("password").value);

    fetch("http://localhost:8081/api/auth/login", {
        method: "POST",
        headers: { "Content-Type": "application/x-www-form-urlencoded" },
        body: formData
    })
    .then(res => res.text())
    .then(response => {
        const msgDiv = document.getElementById("message");
        msgDiv.textContent = response;
        msgDiv.style.color = response.includes("Successful") ? "#00ff00" : "#ff0000";

        if(response.includes("Successful")) {
            document.getElementById("loginForm").reset();
            // Mark user as logged in
            localStorage.setItem("loggedIn", "true");
            localStorage.setItem("userEmail", document.getElementById("email").value);
            // Redirect to token page after 1 sec
            setTimeout(() => { window.location.href = "token.html"; }, 1000);
        }
    })
    .catch(err => {
        const msgDiv = document.getElementById("message");
        msgDiv.textContent = "Backend not reachable!";
        msgDiv.style.color = "#ff0000";
    });
});
</script>

</body>
</html>
